{% extends "Layout.html" %}
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="static/css/mapbox.css" />
</head>

{% block content %}
  <main class="hero-section">
    <div class="container">

      <div class="section-tabs">
        <div class = "places">
          {% for place in places %}
            <article>
              <a class="name" href="{{ place['url'] }}" target="_blank">{{ place['name'] }}</a>
              <a class="walking-distance">{{ place['time'] }} min away</p>
            </article>
          {% endfor %}
        </div>
      </div>

      <div id="map" class="map">

      <script src="static/js/leaflet.js"></script>
      <script>
          var planes = [
            {% for place in places %}
              ["<h3><a href='{{ place['url'] }}' target='_blank'>{{ place['name'] }}</a></h3> <p>{{ place['time'] }} min away</p>", {{ place['lat'] }}, {{ place['lng'] }} ],
            {% endfor %}
          ];

          var map = L.map('map').setView([{{ my_coordinates[0] }}, {{ my_coordinates[1] }}], 15);
          mapLink = '<a href="http://openstreetmap.org">OpenStreetMap</a>';
          L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '&copy; ' + mapLink + ' Contributors',
              maxZoom: 18,
            }
          ).addTo(map);

          for (var i = 0; i < planes.length; i++) {
            marker = new L.marker([planes[i][1],planes[i][2]])
              .bindPopup(planes[i][0])
              .addTo(map);
          }
        </script>
      </div>

      <div class="seciton-map">
        <div class="nav">
          <form method="POST" action="/home">
            {{ form.hidden_tag() }}
              <div class="home-form-group">
                {% if form.address.errors %}
                  {% for err in form.address.errors %}
                    <p class="error-message">{{ error }}</p>
                  {% endfor %}
                {% endif %}
                {{ form.address(placeholder="Explore nearby") }}
              </div>
            {{ form.submit(class="btn-primary-home") }}
          </form>
          </div>
        </div>
        <div class="clearfix"></div>
      </div>
    </div>
  </main>

{% endblock %}
